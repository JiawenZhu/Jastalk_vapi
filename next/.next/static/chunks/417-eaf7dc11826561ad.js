(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[417],{9628:function(e,t,r){"use strict";r.d(t,{Jh:function(){return Z},Z7:function(){return C},Lz:function(){return l},tD:function(){return V},J7:function(){return Q},EC:function(){return L},kg:function(){return N}});for(var i,n,s,a,o,c,l,u,h,d,p,f=r(9645),g=r.n(f),y=r(5445),m=r.n(y),b={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},_=new Uint8Array(16),v=[],k=0;k<256;++k)v.push((k+256).toString(16).slice(1));var w=function(e,t,r){if(b.randomUUID&&!t&&!e)return b.randomUUID();var i=(e=e||{}).random||(e.rng||function(){if(!c&&!(c="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(_)})();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=i[n];return t}return function(e,t=0){return(v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]).toLowerCase()}(i)};function S(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}async function A(e,t,r,i){try{N.debug("[RTVI] Fetch action",e,t);let n=new Headers({...Object.fromEntries((r.headers??new Headers).entries())});n.has("Content-Type")||n.set("Content-Type","application/json"),n.set("Cache-Control","no-cache"),n.set("Connection","keep-alive");let s=await fetch(e,{method:"POST",headers:n,body:JSON.stringify({...r.requestData,actions:[t]})}),a=s.headers.get("content-type");if(!s.ok){let e=await s.text();throw new C(`Failed to resolve action: ${e}`,s.status)}if(s.body&&a?.includes("text/event-stream")){let e=s.body.pipeThrough(new TextDecoderStream).getReader(),t="";for(;;){let{value:r,done:n}=await e.read();if(n)break;let s=(t+=r).indexOf("\n\n");for(;-1!==s;){let e=t.slice(0,s);t=t.slice(s+2);let r=e.split("\n"),n="";for(let e of r){let t=e.indexOf(":");-1!==t&&(n+=e.slice(t+1).trim())}try{let e=atob(n),t=JSON.parse(e);i(t)}catch(e){throw N.error("[RTVI] Failed to parse JSON:",e),e}s=t.indexOf("\n\n")}}}else{let e=await s.json();i(e)}}catch(e){throw N.error("[RTVI] Error during fetch:",e),e}}S({},"httpActionGenerator",()=>A),S({},"RTVIClient",()=>Z);var T={};T=JSON.parse('{"name":"@pipecat-ai/client-js","version":"0.3.4","license":"BSD-2-Clause","main":"dist/index.js","module":"dist/index.module.js","types":"dist/index.d.ts","source":"src/index.ts","repository":{"type":"git","url":"git+https://github.com/pipecat-ai/pipecat-client-web.git"},"files":["dist","package.json","README.md"],"scripts":{"build":"jest --silent && parcel build --no-cache","dev":"parcel watch","lint":"eslint src/ --report-unused-disable-directives --max-warnings 0","test":"jest"},"jest":{"preset":"ts-jest","testEnvironment":"node"},"devDependencies":{"@jest/globals":"^29.7.0","@types/clone-deep":"^4.0.4","@types/jest":"^29.5.12","@types/uuid":"^10.0.0","eslint":"^9.11.1","eslint-config-prettier":"^9.1.0","eslint-plugin-simple-import-sort":"^12.1.1","jest":"^29.7.0","ts-jest":"^29.2.5"},"dependencies":{"@types/events":"^3.0.3","clone-deep":"^4.0.1","events":"^3.3.0","typed-emitter":"^2.1.0","uuid":"^10.0.0"}}');var E={};S(E,"RTVIError",()=>C),S(E,"ConnectionTimeoutError",()=>R),S(E,"StartBotError",()=>B),S(E,"TransportStartError",()=>L),S(E,"BotNotReadyError",()=>I),S(E,"ConfigUpdateError",()=>O),S(E,"ActionEndpointNotSetError",()=>M);class C extends Error{constructor(e,t){super(e),this.status=t}}class R extends C{constructor(e){super(e??"Bot did not enter ready state within the specified timeout period.")}}class B extends C{constructor(e,t){super(e??"Failed to connect / invalid auth bundle from base url",t??500),this.error="invalid-request-error"}}class L extends C{constructor(e){super(e??"Unable to connect to transport")}}class I extends C{constructor(e){super(e??"Attempt to call action on transport when not in 'ready' state.")}}class O extends C{constructor(e){super(e??"Unable to update configuration"),this.status=400}}class M extends C{constructor(e){super(e??"Action endpoint is not set")}}function D(e,t,r){let i=r.value;return r.value=function(...e){if("ready"===this.state)return i.apply(this,e);throw new I(`Attempt to call ${t.toString()} when transport not in ready state. Await connect() first.`)},r}S({},"RTVIEvent",()=>l),(i=l||(l={})).MessageError="messageError",i.Error="error",i.Connected="connected",i.Disconnected="disconnected",i.TransportStateChanged="transportStateChanged",i.Config="config",i.ConfigDescribe="configDescribe",i.ActionsAvailable="actionsAvailable",i.ParticipantConnected="participantConnected",i.ParticipantLeft="participantLeft",i.TrackStarted="trackStarted",i.TrackStopped="trackStopped",i.ScreenTrackStarted="screenTrackStarted",i.ScreenTrackStopped="screenTrackStopped",i.ScreenShareError="screenShareError",i.AvailableCamsUpdated="availableCamsUpdated",i.AvailableMicsUpdated="availableMicsUpdated",i.AvailableSpeakersUpdated="availableSpeakersUpdated",i.CamUpdated="camUpdated",i.MicUpdated="micUpdated",i.SpeakerUpdated="speakerUpdated",i.BotConnected="botConnected",i.BotReady="botReady",i.BotDisconnected="botDisconnected",i.BotStartedSpeaking="botStartedSpeaking",i.BotStoppedSpeaking="botStoppedSpeaking",i.RemoteAudioLevel="remoteAudioLevel",i.UserStartedSpeaking="userStartedSpeaking",i.UserStoppedSpeaking="userStoppedSpeaking",i.LocalAudioLevel="localAudioLevel",i.Metrics="metrics",i.UserTranscript="userTranscript",i.BotTranscript="botTranscript",i.BotLlmText="botLlmText",i.BotLlmStarted="botLlmStarted",i.BotLlmStopped="botLlmStopped",i.BotTtsText="botTtsText",i.BotTtsStarted="botTtsStarted",i.BotTtsStopped="botTtsStopped",i.LLMFunctionCall="llmFunctionCall",i.LLMFunctionCallStart="llmFunctionCallStart",i.LLMJsonCompletion="llmJsonCompletion",i.StorageItemStored="storageItemStored",i.BotLlmSearchResponse="botLlmSearchResponse",i.ServerMessage="serverMessage",S({},"RTVIClientHelper",()=>P);class P{constructor(e){this._options=e}set client(e){this._client=e}set service(e){this._service=e}}var U={};S(U,"LogLevel",()=>u),S(U,"logger",()=>N),(n=u||(u={}))[n.NONE=0]="NONE",n[n.ERROR=1]="ERROR",n[n.WARN=2]="WARN",n[n.INFO=3]="INFO",n[n.DEBUG=4]="DEBUG";class x{constructor(){this.level=u.DEBUG}static getInstance(){return x.instance||(x.instance=new x),x.instance}setLevel(e){this.level=e}debug(...e){this.level>=u.DEBUG&&console.debug(...e)}info(...e){this.level>=u.INFO&&console.info(...e)}warn(...e){this.level>=u.WARN&&console.warn(...e)}error(...e){this.level>=u.ERROR&&console.error(...e)}}let N=x.getInstance();var F={};S(F,"RTVI_MESSAGE_LABEL",()=>j),S(F,"RTVIMessageType",()=>h),S(F,"RTVIMessage",()=>V),S(F,"RTVIActionRequest",()=>q),S(F,"MessageDispatcher",()=>z);let j="rtvi-ai";(s=h||(h={})).CLIENT_READY="client-ready",s.UPDATE_CONFIG="update-config",s.GET_CONFIG="get-config",s.DESCRIBE_CONFIG="describe-config",s.DESCRIBE_ACTIONS="describe-actions",s.DISCONNECT_BOT="disconnect-bot",s.ACTION="action",s.BOT_READY="bot-ready",s.ERROR="error",s.ERROR_RESPONSE="error-response",s.CONFIG="config",s.CONFIG_AVAILABLE="config-available",s.CONFIG_ERROR="config-error",s.ACTIONS_AVAILABLE="actions-available",s.ACTION_RESPONSE="action-response",s.METRICS="metrics",s.USER_TRANSCRIPTION="user-transcription",s.BOT_TRANSCRIPTION="bot-transcription",s.USER_STARTED_SPEAKING="user-started-speaking",s.USER_STOPPED_SPEAKING="user-stopped-speaking",s.BOT_STARTED_SPEAKING="bot-started-speaking",s.BOT_STOPPED_SPEAKING="bot-stopped-speaking",s.USER_LLM_TEXT="user-llm-text",s.BOT_LLM_TEXT="bot-llm-text",s.BOT_LLM_STARTED="bot-llm-started",s.BOT_LLM_STOPPED="bot-llm-stopped",s.BOT_TTS_TEXT="bot-tts-text",s.BOT_TTS_STARTED="bot-tts-started",s.BOT_TTS_STOPPED="bot-tts-stopped",s.BOT_LLM_SEARCH_RESPONSE="bot-llm-search-response",s.STORAGE_ITEM_STORED="storage-item-stored",s.SERVER_MESSAGE="server-message";class V{constructor(e,t,r){this.label=j,this.type=e,this.data=t,this.id=r||w().slice(0,8)}static clientReady(){return new V(h.CLIENT_READY,{})}static updateConfig(e,t=!1){return new V(h.UPDATE_CONFIG,{config:e,interrupt:t})}static describeConfig(){return new V(h.DESCRIBE_CONFIG,{})}static getBotConfig(){return new V(h.GET_CONFIG,{})}static describeActions(){return new V(h.DESCRIBE_ACTIONS,{})}static disconnectBot(){return new V(h.DISCONNECT_BOT,{})}static error(e,t=!1){return new V(h.ERROR,{message:e,fatal:t})}}class q extends V{constructor(e){super(h.ACTION,e)}}class z{constructor(e){this._queue=[],this._gcTime=1e4,this._queue=[],this._client=e}dispatch(e){let t=new Promise((t,r)=>{this._queue.push({message:e,timestamp:Date.now(),resolve:t,reject:r})});return N.debug("[MessageDispatcher] dispatch",e),this._client.sendMessage(e),this._gc(),t}async dispatchAction(e,t){let r=new Promise((t,r)=>{this._queue.push({message:e,timestamp:Date.now(),resolve:t,reject:r})});if(N.debug("[MessageDispatcher] action",e),this._client.connected)this._client.sendMessage(e);else{if(!this._client.params.endpoints?.action)throw N.error("[MessageDispatcher] Action endpoint is required when dispatching action in disconnected state"),new M;let r=this._client.constructUrl("action");try{await A(r,e,this._client.params,e=>{t(e)})}catch(i){t(new V(h.ERROR_RESPONSE,`Action endpoint '${r}' returned an error response`,e.id))}}return this._gc(),r}_resolveReject(e,t=!0){let r=this._queue.find(t=>t.message.id===e.id);return r&&(t?(N.debug("[MessageDispatcher] Resolve",e),r.resolve((e.type,h.ACTION_RESPONSE,e))):(N.debug("[MessageDispatcher] Reject",e),r.reject(e)),this._queue=this._queue.filter(t=>t.message.id!==e.id),N.debug("[MessageDispatcher] Queue",this._queue)),e}resolve(e){return this._resolveReject(e,!0)}reject(e){return this._resolveReject(e,!1)}_gc(){this._queue=this._queue.filter(e=>Date.now()-e.timestamp<this._gcTime),N.debug("[MessageDispatcher] GC",this._queue)}}var G=function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};let W={connect:"/connect",action:"/action"};class H{constructor(e){this._transport=e,this._proxy=new Proxy(this._transport,{get:(e,t,r)=>{if("function"==typeof e[t]){let r;switch(String(t)){case"initialize":r="Calls to initialize() are disabled and used internally by the RTVIClient";break;case"sendReadyMessage":r="Calls to sendReadyMessage() are disabled and used internally by the RTVIClient";break;case"connect":r="Calls to connect() are disabled. Please use RTVIClient.connect()";break;case"disconnect":r="Calls to disconnect() are disabled. Please use RTVIClient.disconnect()"}return r?()=>{throw Error(r)}:(...r)=>e[t](...r)}return Reflect.get(e,t,r)}})}get proxy(){return this._proxy}}class J extends m(){}class Z extends J{constructor(e){super(),this.params={...e.params,endpoints:{...W,...e.params.endpoints??{}}},this._helpers={},this._transport=e.transport,this._transportWrapper=new H(this._transport);let t={...e.callbacks,onMessageError:t=>{e?.callbacks?.onMessageError?.(t),this.emit(l.MessageError,t)},onError:t=>{e?.callbacks?.onError?.(t);try{this.emit(l.Error,t)}catch(e){N.debug("Could not emit error",t)}let r=t.data;r?.fatal&&(N.error("Fatal error reported. Disconnecting..."),this.disconnect())},onConnected:()=>{e?.callbacks?.onConnected?.(),this.emit(l.Connected)},onDisconnected:()=>{e?.callbacks?.onDisconnected?.(),this.emit(l.Disconnected)},onTransportStateChanged:t=>{e?.callbacks?.onTransportStateChanged?.(t),this.emit(l.TransportStateChanged,t)},onConfig:t=>{e?.callbacks?.onConfig?.(t),this.emit(l.Config,t)},onConfigDescribe:t=>{e?.callbacks?.onConfigDescribe?.(t),this.emit(l.ConfigDescribe,t)},onActionsAvailable:t=>{e?.callbacks?.onActionsAvailable?.(t),this.emit(l.ActionsAvailable,t)},onParticipantJoined:t=>{e?.callbacks?.onParticipantJoined?.(t),this.emit(l.ParticipantConnected,t)},onParticipantLeft:t=>{e?.callbacks?.onParticipantLeft?.(t),this.emit(l.ParticipantLeft,t)},onTrackStarted:(t,r)=>{e?.callbacks?.onTrackStarted?.(t,r),this.emit(l.TrackStarted,t,r)},onTrackStopped:(t,r)=>{e?.callbacks?.onTrackStopped?.(t,r),this.emit(l.TrackStopped,t,r)},onScreenTrackStarted:(t,r)=>{e?.callbacks?.onScreenTrackStarted?.(t,r),this.emit(l.ScreenTrackStarted,t,r)},onScreenTrackStopped:(t,r)=>{e?.callbacks?.onScreenTrackStopped?.(t,r),this.emit(l.ScreenTrackStopped,t,r)},onScreenShareError:t=>{e?.callbacks?.onScreenShareError?.(t),this.emit(l.ScreenShareError,t)},onAvailableCamsUpdated:t=>{e?.callbacks?.onAvailableCamsUpdated?.(t),this.emit(l.AvailableCamsUpdated,t)},onAvailableMicsUpdated:t=>{e?.callbacks?.onAvailableMicsUpdated?.(t),this.emit(l.AvailableMicsUpdated,t)},onAvailableSpeakersUpdated:t=>{e?.callbacks?.onAvailableSpeakersUpdated?.(t),this.emit(l.AvailableSpeakersUpdated,t)},onCamUpdated:t=>{e?.callbacks?.onCamUpdated?.(t),this.emit(l.CamUpdated,t)},onMicUpdated:t=>{e?.callbacks?.onMicUpdated?.(t),this.emit(l.MicUpdated,t)},onSpeakerUpdated:t=>{e?.callbacks?.onSpeakerUpdated?.(t),this.emit(l.SpeakerUpdated,t)},onBotConnected:t=>{e?.callbacks?.onBotConnected?.(t),this.emit(l.BotConnected,t)},onBotReady:t=>{e?.callbacks?.onBotReady?.(t),this.emit(l.BotReady,t)},onBotDisconnected:t=>{e?.callbacks?.onBotDisconnected?.(t),this.emit(l.BotDisconnected,t)},onBotStartedSpeaking:()=>{e?.callbacks?.onBotStartedSpeaking?.(),this.emit(l.BotStartedSpeaking)},onBotStoppedSpeaking:()=>{e?.callbacks?.onBotStoppedSpeaking?.(),this.emit(l.BotStoppedSpeaking)},onRemoteAudioLevel:(t,r)=>{e?.callbacks?.onRemoteAudioLevel?.(t,r),this.emit(l.RemoteAudioLevel,t,r)},onUserStartedSpeaking:()=>{e?.callbacks?.onUserStartedSpeaking?.(),this.emit(l.UserStartedSpeaking)},onUserStoppedSpeaking:()=>{e?.callbacks?.onUserStoppedSpeaking?.(),this.emit(l.UserStoppedSpeaking)},onLocalAudioLevel:t=>{e?.callbacks?.onLocalAudioLevel?.(t),this.emit(l.LocalAudioLevel,t)},onUserTranscript:t=>{e?.callbacks?.onUserTranscript?.(t),this.emit(l.UserTranscript,t)},onBotTranscript:t=>{e?.callbacks?.onBotTranscript?.(t),this.emit(l.BotTranscript,t)},onBotLlmText:t=>{e?.callbacks?.onBotLlmText?.(t),this.emit(l.BotLlmText,t)},onBotLlmStarted:()=>{e?.callbacks?.onBotLlmStarted?.(),this.emit(l.BotLlmStarted)},onBotLlmStopped:()=>{e?.callbacks?.onBotLlmStopped?.(),this.emit(l.BotLlmStopped)},onBotTtsText:t=>{e?.callbacks?.onBotTtsText?.(t),this.emit(l.BotTtsText,t)},onBotTtsStarted:()=>{e?.callbacks?.onBotTtsStarted?.(),this.emit(l.BotTtsStarted)},onBotTtsStopped:()=>{e?.callbacks?.onBotTtsStopped?.(),this.emit(l.BotTtsStopped)},onStorageItemStored:t=>{e?.callbacks?.onStorageItemStored?.(t),this.emit(l.StorageItemStored,t)}};this._options={...e,callbacks:t,enableMic:e.enableMic??!0,enableCam:e.enableCam??!1},this._initialize(),N.debug("[RTVI Client] Initialized",this.version)}constructUrl(e){if(!this.params.baseUrl)throw new C("Base URL not set. Please set rtviClient.params.baseUrl");return this.params.baseUrl.replace(/\/+$/,"")+(this.params.endpoints?.[e]??"")}setLogLevel(e){N.setLevel(e)}async initDevices(){N.debug("[RTVI Client] Initializing devices..."),await this._transport.initDevices()}async connect(){if(["authenticating","connecting","connected","ready"].includes(this._transport.state))throw new C("Voice client has already been started. Please call disconnect() before starting again.");return this._abortController=new AbortController,new Promise((e,t)=>{(async()=>{let r;this._startResolve=e,"disconnected"===this._transport.state&&await this._transport.initDevices(),this._transport.state="authenticating",this._options.timeout&&(this._handshakeTimeout=setTimeout(async()=>{this._abortController?.abort(),await this.disconnect(),this._transport.state="error",t(new R)},this._options.timeout));let i=this._options.customConnectHandler;if(N.debug("[RTVI Client] Start params",this.params),this.params={...this.params,requestData:{...this.params.requestData,rtvi_client_version:this.version}},this.params.baseUrl||this.params.endpoints?.connect){let e=this.constructUrl("connect");N.debug("[RTVI Client] Connecting...",e),N.debug("[RTVI Client] Start params",this.params);try{r=i?await i(this.params,this._handshakeTimeout,this._abortController):await fetch(e,{method:"POST",mode:"cors",headers:new Headers({"Content-Type":"application/json",...Object.fromEntries((this.params.headers??new Headers).entries())}),body:JSON.stringify({config:this.params.config,...this.params.services?{services:this.params.services}:{},...this.params.requestData}),signal:this._abortController?.signal}).then(e=>(clearTimeout(this._handshakeTimeout),e.ok)?e.json():Promise.reject(e))}catch(e){if(clearTimeout(this._handshakeTimeout),this._abortController?.signal.aborted)return;if(this._transport.state="error",e instanceof Response){let r=await e.json();t(new B(r.info??r.detail??e.statusText,e.status))}else t(new B);return}N.debug("[RTVI Client] Auth bundle received",r)}else N.debug("[RTVI Client] Connecting directly (skipping handshake / auth)..."),clearTimeout(this._handshakeTimeout);try{await this._transport.connect(r,this._abortController),await this._transport.sendReadyMessage()}catch(e){clearTimeout(this._handshakeTimeout),this.disconnect(),t(e);return}})()})}async disconnect(){this._abortController&&this._abortController.abort(),clearTimeout(this._handshakeTimeout),await this._transport.disconnect(),this._messageDispatcher=new z(this)}_initialize(){this._transport.initialize(this._options,this.handleMessage.bind(this)),this._messageDispatcher=new z(this)}get connected(){return["connected","ready"].includes(this._transport.state)}get transport(){return this._transportWrapper.proxy}get state(){return this._transport.state}get version(){var e;return((e=T)&&e.__esModule?e.default:e).version}async getAllMics(){return await this._transport.getAllMics()}async getAllCams(){return await this._transport.getAllCams()}async getAllSpeakers(){return await this._transport.getAllSpeakers()}get selectedMic(){return this._transport.selectedMic}get selectedCam(){return this._transport.selectedCam}get selectedSpeaker(){return this._transport.selectedSpeaker}updateMic(e){this._transport.updateMic(e)}updateCam(e){this._transport.updateCam(e)}updateSpeaker(e){this._transport.updateSpeaker(e)}enableMic(e){this._transport.enableMic(e)}get isMicEnabled(){return this._transport.isMicEnabled}enableCam(e){this._transport.enableCam(e)}get isCamEnabled(){return this._transport.isCamEnabled}tracks(){return this._transport.tracks()}enableScreenShare(e){return this._transport.enableScreenShare(e)}get isSharingScreen(){return this._transport.isSharingScreen}async getConfig(){return(await this._messageDispatcher.dispatch(V.getBotConfig())).data.config}async updateConfig(e,t=!1){return N.debug("[RTVI Client] Updating config",e),this._messageDispatcher.dispatch(V.updateConfig(e,t))}async describeConfig(){return this._messageDispatcher.dispatch(V.describeConfig())}async getServiceOptionsFromConfig(e,t){if(!t&&"ready"!==this.state)throw new I("getServiceOptionsFromConfig called without config array before bot is ready");return Promise.resolve().then(async()=>{if(!e){N.debug("Target service name is required");return}let r=(t??await this.getConfig()).find(t=>t.service===e);if(!r){N.debug("No service with name "+e+" not found in config");return}return r})}async getServiceOptionValueFromConfig(e,t,r){let i=await this.getServiceOptionsFromConfig(e,r);if(!i){N.debug("Service with name "+e+" not found in config");return}let n=i.options.find(e=>e.name===t);return n?n.value:void 0}_updateOrAddOption(e,t){let r=e.findIndex(e=>e.name===t.name);return -1!==r?e.map((e,i)=>i===r?{...e,value:t.value}:e):[...e,{name:t.name,value:t.value}]}async setServiceOptionInConfig(e,t,r){let i=g()(r??await this.getConfig());if(!await this.getServiceOptionsFromConfig(e,i))return N.debug("Service with name '"+e+"' not found in config"),i;for(let r of Array.isArray(t)?t:[t]){let t=i.find(t=>t.service===e),n=t?this._updateOrAddOption(t.options,r):[{name:r.name,value:r.value}];t?t.options=n:i.push({service:e,options:n})}return i}async setConfigOptions(e,t){let r=g()(t??await this.getConfig());for(let t of e)r=await this.setServiceOptionInConfig(t.service,t.options,r)||r;return r}async action(e){return this._messageDispatcher.dispatchAction(new q(e),this.handleMessage.bind(this))}async describeActions(){return this._messageDispatcher.dispatch(V.describeActions())}get transportExpiry(){return this._transport.expiry}sendMessage(e){this._transport.sendMessage(e)}disconnectBot(){this._transport.sendMessage(new V(h.DISCONNECT_BOT,{}))}handleMessage(e){switch(N.debug("[RTVI Message]",e),e.type){case h.BOT_READY:clearTimeout(this._handshakeTimeout),this._startResolve?.(e.data),this._options.callbacks?.onBotReady?.(e.data);break;case h.CONFIG_AVAILABLE:this._messageDispatcher.resolve(e),this._options.callbacks?.onConfigDescribe?.(e.data);break;case h.CONFIG:{let t=this._messageDispatcher.resolve(e);this._options.callbacks?.onConfig?.(t.data.config);break}case h.ACTIONS_AVAILABLE:this._messageDispatcher.resolve(e),this._options.callbacks?.onActionsAvailable?.(e.data);break;case h.ACTION_RESPONSE:this._messageDispatcher.resolve(e);break;case h.ERROR_RESPONSE:{let t=this._messageDispatcher.reject(e);this._options.callbacks?.onMessageError?.(t);break}case h.ERROR:this._options.callbacks?.onError?.(e);break;case h.USER_STARTED_SPEAKING:this._options.callbacks?.onUserStartedSpeaking?.();break;case h.USER_STOPPED_SPEAKING:this._options.callbacks?.onUserStoppedSpeaking?.();break;case h.BOT_STARTED_SPEAKING:this._options.callbacks?.onBotStartedSpeaking?.();break;case h.BOT_STOPPED_SPEAKING:this._options.callbacks?.onBotStoppedSpeaking?.();break;case h.USER_TRANSCRIPTION:{let t=e.data;this._options.callbacks?.onUserTranscript?.(t);break}case h.BOT_TRANSCRIPTION:this._options.callbacks?.onBotTranscript?.(e.data);break;case h.BOT_LLM_TEXT:this._options.callbacks?.onBotLlmText?.(e.data);break;case h.BOT_LLM_STARTED:this._options.callbacks?.onBotLlmStarted?.();break;case h.BOT_LLM_STOPPED:this._options.callbacks?.onBotLlmStopped?.();break;case h.BOT_TTS_TEXT:this._options.callbacks?.onBotTtsText?.(e.data);break;case h.BOT_TTS_STARTED:this._options.callbacks?.onBotTtsStarted?.();break;case h.BOT_TTS_STOPPED:this._options.callbacks?.onBotTtsStopped?.();break;case h.BOT_LLM_SEARCH_RESPONSE:this._options.callbacks?.onBotLlmSearchResponse?.(e.data),this.emit(l.BotLlmSearchResponse,e.data);break;case h.METRICS:this.emit(l.Metrics,e.data),this._options.callbacks?.onMetrics?.(e.data);break;case h.STORAGE_ITEM_STORED:this._options.callbacks?.onStorageItemStored?.(e.data);break;case h.SERVER_MESSAGE:this._options.callbacks?.onServerMessage?.(e.data),this.emit(l.ServerMessage,e.data);break;default:{let t=!1;for(let r of Object.values(this._helpers))r.getMessageTypes().includes(e.type)&&(t=!0,r.handleMessage(e));t||this._options.callbacks?.onGenericMessage?.(e.data)}}}registerHelper(e,t){if(this._helpers[e])throw Error(`Helper with name '${e}' already registered`);if(!(t instanceof P))throw Error("Helper must be an instance of RTVIClientHelper");return t.service=e,t.client=this,this._helpers[e]=t,this._helpers[e]}getHelper(e){let t=this._helpers[e];if(!t){N.debug(`Helper targeting service '${e}' not found`);return}return t}unregisterHelper(e){this._helpers[e]&&delete this._helpers[e]}}G([D],Z.prototype,"getConfig",null),G([D],Z.prototype,"updateConfig",null),G([D],Z.prototype,"describeConfig",null),G([D],Z.prototype,"describeActions",null),G([function(...e){return e=["ready",...e],function(t,r,i){let n=i.get;return i.get=function(){if(e.includes(this.state))return n?.apply(this);throw new I(`Attempt to call ${r.toString()} when transport not in ${e}. Await connect() first.`)},i}}("connected","ready")],Z.prototype,"transportExpiry",null),G([D],Z.prototype,"sendMessage",null),G([D],Z.prototype,"disconnectBot",null);var $={};S($,"LLMMessageType",()=>d),S($,"LLMActionType",()=>p),S($,"LLMHelper",()=>Y),(a=d||(d={})).LLM_FUNCTION_CALL="llm-function-call",a.LLM_FUNCTION_CALL_START="llm-function-call-start",a.LLM_FUNCTION_CALL_RESULT="llm-function-call-result",a.LLM_JSON_COMPLETION="llm-json-completion",(o=p||(p={})).APPEND_TO_MESSAGES="append_to_messages",o.GET_CONTEXT="get_context",o.SET_CONTEXT="set_context",o.RUN="run";class Y extends P{constructor(e){super(e),this._functionCallCallback=null}getMessageTypes(){return Object.values(d)}async getContext(){if("ready"!==this._client.state)throw new I("getContext called while transport not in ready state");return(await this._client.action({service:this._service,action:p.GET_CONTEXT})).data.result}async setContext(e,t=!1){if("ready"!==this._client.state)throw new I("setContext called while transport not in ready state");return!!(await this._client.action({service:this._service,action:p.SET_CONTEXT,arguments:[{name:"messages",value:e.messages},{name:"interrupt",value:t}]})).data.result}async appendToMessages(e,t=!1){if("ready"!==this._client.state)throw new I("setContext called while transport not in ready state");return!!(await this._client.action({service:this._service,action:p.APPEND_TO_MESSAGES,arguments:[{name:"messages",value:[e]},{name:"run_immediately",value:t}]})).data.result}async run(e=!1){if("ready"===this._client.state)return this._client.action({service:this._service,action:p.RUN,arguments:[{name:"interrupt",value:e}]})}handleFunctionCall(e){this._functionCallCallback=e}handleMessage(e){switch(e.type){case d.LLM_JSON_COMPLETION:this._options.callbacks?.onLLMJsonCompletion?.(e.data),this._client.emit(l.LLMJsonCompletion,e.data);break;case d.LLM_FUNCTION_CALL:{let t=e.data;if(this._options.callbacks?.onLLMFunctionCall?.(e.data),this._client.emit(l.LLMFunctionCall,e.data),this._functionCallCallback){let e={functionName:t.function_name,arguments:t.args};if("ready"===this._client.state)this._functionCallCallback(e).then(e=>{this._client.sendMessage(new V(d.LLM_FUNCTION_CALL_RESULT,{function_name:t.function_name,tool_call_id:t.tool_call_id,arguments:t.args,result:e}))});else throw new I("Attempted to send a function call result from bot while transport not in ready state")}break}case d.LLM_FUNCTION_CALL_START:{let t=e.data;this._options.callbacks?.onLLMFunctionCallStart?.(t.function_name),this._client.emit(l.LLMFunctionCallStart,t.function_name)}}}}S({},"Transport",()=>Q);class Q{constructor(){this._state="disconnected",this._expiry=void 0}get expiry(){return this._expiry}}},2618:function(e,t,r){"use strict";r.d(t,{p:function(){return E}});var i,n,s=r(5984),a=r(9628);function o(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}var c={};o(c,"DailyRTVIMessageType",()=>n),o(c,"DailyTransport",()=>E);class l{static floatTo16BitPCM(e){let t=new ArrayBuffer(2*e.length),r=new DataView(t),i=0;for(let t=0;t<e.length;t++,i+=2){let n=Math.max(-1,Math.min(1,e[t]));r.setInt16(i,n<0?32768*n:32767*n,!0)}return t}static mergeBuffers(e,t){let r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),r.buffer}_packData(e,t){return[new Uint8Array([t,t>>8]),new Uint8Array([t,t>>8,t>>16,t>>24])][e]}pack(e,t){if(t?.bitsPerSample){if(t?.channels){if(!t?.data)throw Error('Missing "data"')}else throw Error('Missing "channels"')}else throw Error('Missing "bitsPerSample"');let{bitsPerSample:r,channels:i,data:n}=t,s=new Blob(["RIFF",this._packData(1,52),"WAVE","fmt ",this._packData(1,16),this._packData(0,1),this._packData(0,i.length),this._packData(1,e),this._packData(1,e*i.length*r/8),this._packData(0,i.length*r/8),this._packData(0,r),"data",this._packData(1,i[0].length*i.length*r/8),n],{type:"audio/mpeg"}),a=URL.createObjectURL(s);return{blob:s,url:a,channelCount:i.length,sampleRate:e,duration:n.byteLength/(i.length*e*2)}}}globalThis.WavPacker=l;let u=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],h=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],d=[],p=[];for(let e=1;e<=8;e++)for(let t=0;t<u.length;t++){let r=u[t];d.push(r/Math.pow(2,8-e)),p.push(h[t]+e)}let f=d.filter((e,t)=>d[t]>32&&d[t]<2e3),g=p.filter((e,t)=>d[t]>32&&d[t]<2e3);class y{static getFrequencies(e,t,r,i="frequency",n=-100,s=-30){let a,o,c;r||(r=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(r));let l=1/r.length*(t/2);if("music"===i||"voice"===i){let e="voice"===i?f:d,t=Array(e.length).fill(n);for(let i=0;i<r.length;i++){let n=i*l,s=r[i];for(let r=e.length-1;r>=0;r--)if(n>e[r]){t[r]=Math.max(t[r],s);break}}a=t,o="voice"===i?f:d,c="voice"===i?g:p}else c=(o=(a=Array.from(r)).map((e,t)=>l*t)).map(e=>`${e.toFixed(2)} Hz`);return{values:new Float32Array(a.map(e=>Math.max(0,Math.min((e-n)/(s-n),1)))),frequencies:o,labels:c}}constructor(e,t=null){if(this.fftResults=[],t){let{length:r,sampleRate:i}=t,n=new OfflineAudioContext({length:r,sampleRate:i}),s=n.createBufferSource();s.buffer=t;let a=n.createAnalyser();a.fftSize=8192,a.smoothingTimeConstant=.1,s.connect(a);let o=1/60,c=r/i,l=e=>{let t=o*e;t<c&&n.suspend(t).then(()=>{let t=new Float32Array(a.frequencyBinCount);a.getFloatFrequencyData(t),this.fftResults.push(t),l(e+1)}),1===e?n.startRendering():n.resume()};s.start(0),l(1),this.audio=e,this.context=n,this.analyser=a,this.sampleRate=i,this.audioBuffer=t}else{let t=new AudioContext,r=t.createMediaElementSource(e),i=t.createAnalyser();i.fftSize=8192,i.smoothingTimeConstant=.1,r.connect(i),i.connect(t.destination),this.audio=e,this.context=t,this.analyser=i,this.sampleRate=this.context.sampleRate,this.audioBuffer=null}}getFrequencies(e="frequency",t=-100,r=-30){let i=null;if(this.audioBuffer&&this.fftResults.length){let e=Math.min(this.audio.currentTime/this.audio.duration*this.fftResults.length|0,this.fftResults.length-1);i=this.fftResults[e]}return y.getFrequencies(this.analyser,this.sampleRate,i,e,t,r)}async resumeIfSuspended(){return"suspended"===this.context.state&&await this.context.resume(),!0}}globalThis.AudioAnalysis=y;let m=new Blob([`
class StreamProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.hasStarted = false;
    this.hasInterrupted = false;
    this.outputBuffers = [];
    this.bufferLength = 128;
    this.write = { buffer: new Float32Array(this.bufferLength), trackId: null };
    this.writeOffset = 0;
    this.trackSampleOffsets = {};
    this.port.onmessage = (event) => {
      if (event.data) {
        const payload = event.data;
        if (payload.event === 'write') {
          const int16Array = payload.buffer;
          const float32Array = new Float32Array(int16Array.length);
          for (let i = 0; i < int16Array.length; i++) {
            float32Array[i] = int16Array[i] / 0x8000; // Convert Int16 to Float32
          }
          this.writeData(float32Array, payload.trackId);
        } else if (
          payload.event === 'offset' ||
          payload.event === 'interrupt'
        ) {
          const requestId = payload.requestId;
          const trackId = this.write.trackId;
          const offset = this.trackSampleOffsets[trackId] || 0;
          this.port.postMessage({
            event: 'offset',
            requestId,
            trackId,
            offset,
          });
          if (payload.event === 'interrupt') {
            this.hasInterrupted = true;
          }
        } else {
          throw new Error(\`Unhandled event "\${payload.event}"\`);
        }
      }
    };
  }

  writeData(float32Array, trackId = null) {
    let { buffer } = this.write;
    let offset = this.writeOffset;
    for (let i = 0; i < float32Array.length; i++) {
      buffer[offset++] = float32Array[i];
      if (offset >= buffer.length) {
        this.outputBuffers.push(this.write);
        this.write = { buffer: new Float32Array(this.bufferLength), trackId };
        buffer = this.write.buffer;
        offset = 0;
      }
    }
    this.writeOffset = offset;
    return true;
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0];
    const outputChannelData = output[0];
    const outputBuffers = this.outputBuffers;
    if (this.hasInterrupted) {
      this.port.postMessage({ event: 'stop' });
      return false;
    } else if (outputBuffers.length) {
      this.hasStarted = true;
      const { buffer, trackId } = outputBuffers.shift();
      for (let i = 0; i < outputChannelData.length; i++) {
        outputChannelData[i] = buffer[i] || 0;
      }
      if (trackId) {
        this.trackSampleOffsets[trackId] =
          this.trackSampleOffsets[trackId] || 0;
        this.trackSampleOffsets[trackId] += buffer.length;
      }
      return true;
    } else if (this.hasStarted) {
      this.port.postMessage({ event: 'stop' });
      return false;
    } else {
      return true;
    }
  }
}

registerProcessor('stream_processor', StreamProcessor);
`],{type:"application/javascript"}),b=URL.createObjectURL(m);class _{constructor({sampleRate:e=44100}={}){this.scriptSrc=b,this.sampleRate=e,this.context=null,this.stream=null,this.analyser=null,this.trackSampleOffsets={},this.interruptedTrackIds={}}async connect(){this.context=new AudioContext({sampleRate:this.sampleRate}),this._speakerID&&this.context.setSinkId(this._speakerID),"suspended"===this.context.state&&await this.context.resume();try{await this.context.audioWorklet.addModule(this.scriptSrc)}catch(e){throw console.error(e),Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}let e=this.context.createAnalyser();return e.fftSize=8192,e.smoothingTimeConstant=.1,this.analyser=e,!0}getFrequencies(e="frequency",t=-100,r=-30){if(!this.analyser)throw Error("Not connected, please call .connect() first");return y.getFrequencies(this.analyser,this.sampleRate,null,e,t,r)}async updateSpeaker(e){let t=this._speakerID;if(this._speakerID=e,this.context)try{"default"===e?await this.context.setSinkId():await this.context.setSinkId(e)}catch(r){console.error(`Could not set sinkId to ${e}: ${r}`),this._speakerID=t}}_start(){let e=new AudioWorkletNode(this.context,"stream_processor");return e.connect(this.context.destination),e.port.onmessage=t=>{let{event:r}=t.data;if("stop"===r)e.disconnect(),this.stream=null;else if("offset"===r){let{requestId:e,trackId:r,offset:i}=t.data,n=i/this.sampleRate;this.trackSampleOffsets[e]={trackId:r,offset:i,currentTime:n}}},this.analyser.disconnect(),e.connect(this.analyser),this.stream=e,!0}add16BitPCM(e,t="default"){let r;if("string"!=typeof t)throw Error("trackId must be a string");if(!this.interruptedTrackIds[t]){if(this.stream||this._start(),e instanceof Int16Array)r=e;else if(e instanceof ArrayBuffer)r=new Int16Array(e);else throw Error("argument must be Int16Array or ArrayBuffer");return this.stream.port.postMessage({event:"write",buffer:r,trackId:t}),r}}async getTrackSampleOffset(e=!1){let t;if(!this.stream)return null;let r=crypto.randomUUID();for(this.stream.port.postMessage({event:e?"interrupt":"offset",requestId:r});!t;)t=this.trackSampleOffsets[r],await new Promise(e=>setTimeout(()=>e(),1));let{trackId:i}=t;return e&&i&&(this.interruptedTrackIds[i]=!0),t}async interrupt(){return this.getTrackSampleOffset(!0)}}globalThis.WavStreamPlayer=_;let v=new Blob([`
class AudioProcessor extends AudioWorkletProcessor {

  constructor() {
    super();
    this.port.onmessage = this.receive.bind(this);
    this.initialize();
  }

  initialize() {
    this.foundAudio = false;
    this.recording = false;
    this.chunks = [];
  }

  /**
   * Concatenates sampled chunks into channels
   * Format is chunk[Left[], Right[]]
   */
  readChannelData(chunks, channel = -1, maxChannels = 9) {
    let channelLimit;
    if (channel !== -1) {
      if (chunks[0] && chunks[0].length - 1 < channel) {
        throw new Error(
          \`Channel \${channel} out of range: max \${chunks[0].length}\`
        );
      }
      channelLimit = channel + 1;
    } else {
      channel = 0;
      channelLimit = Math.min(chunks[0] ? chunks[0].length : 1, maxChannels);
    }
    const channels = [];
    for (let n = channel; n < channelLimit; n++) {
      const length = chunks.reduce((sum, chunk) => {
        return sum + chunk[n].length;
      }, 0);
      const buffers = chunks.map((chunk) => chunk[n]);
      const result = new Float32Array(length);
      let offset = 0;
      for (let i = 0; i < buffers.length; i++) {
        result.set(buffers[i], offset);
        offset += buffers[i].length;
      }
      channels[n] = result;
    }
    return channels;
  }

  /**
   * Combines parallel audio data into correct format,
   * channels[Left[], Right[]] to float32Array[LRLRLRLR...]
   */
  formatAudioData(channels) {
    if (channels.length === 1) {
      // Simple case is only one channel
      const float32Array = channels[0].slice();
      const meanValues = channels[0].slice();
      return { float32Array, meanValues };
    } else {
      const float32Array = new Float32Array(
        channels[0].length * channels.length
      );
      const meanValues = new Float32Array(channels[0].length);
      for (let i = 0; i < channels[0].length; i++) {
        const offset = i * channels.length;
        let meanValue = 0;
        for (let n = 0; n < channels.length; n++) {
          float32Array[offset + n] = channels[n][i];
          meanValue += channels[n][i];
        }
        meanValues[i] = meanValue / channels.length;
      }
      return { float32Array, meanValues };
    }
  }

  /**
   * Converts 32-bit float data to 16-bit integers
   */
  floatTo16BitPCM(float32Array) {
    const buffer = new ArrayBuffer(float32Array.length * 2);
    const view = new DataView(buffer);
    let offset = 0;
    for (let i = 0; i < float32Array.length; i++, offset += 2) {
      let s = Math.max(-1, Math.min(1, float32Array[i]));
      view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7fff, true);
    }
    return buffer;
  }

  /**
   * Retrieves the most recent amplitude values from the audio stream
   * @param {number} channel
   */
  getValues(channel = -1) {
    const channels = this.readChannelData(this.chunks, channel);
    const { meanValues } = this.formatAudioData(channels);
    return { meanValues, channels };
  }

  /**
   * Exports chunks as an audio/wav file
   */
  export() {
    const channels = this.readChannelData(this.chunks);
    const { float32Array, meanValues } = this.formatAudioData(channels);
    const audioData = this.floatTo16BitPCM(float32Array);
    return {
      meanValues: meanValues,
      audio: {
        bitsPerSample: 16,
        channels: channels,
        data: audioData,
      },
    };
  }

  receive(e) {
    const { event, id } = e.data;
    let receiptData = {};
    switch (event) {
      case 'start':
        this.recording = true;
        break;
      case 'stop':
        this.recording = false;
        break;
      case 'clear':
        this.initialize();
        break;
      case 'export':
        receiptData = this.export();
        break;
      case 'read':
        receiptData = this.getValues();
        break;
      default:
        break;
    }
    // Always send back receipt
    this.port.postMessage({ event: 'receipt', id, data: receiptData });
  }

  sendChunk(chunk) {
    const channels = this.readChannelData([chunk]);
    const { float32Array, meanValues } = this.formatAudioData(channels);
    const rawAudioData = this.floatTo16BitPCM(float32Array);
    const monoAudioData = this.floatTo16BitPCM(meanValues);
    this.port.postMessage({
      event: 'chunk',
      data: {
        mono: monoAudioData,
        raw: rawAudioData,
      },
    });
  }

  process(inputList, outputList, parameters) {
    // Copy input to output (e.g. speakers)
    // Note that this creates choppy sounds with Mac products
    const sourceLimit = Math.min(inputList.length, outputList.length);
    for (let inputNum = 0; inputNum < sourceLimit; inputNum++) {
      const input = inputList[inputNum];
      const output = outputList[inputNum];
      const channelCount = Math.min(input.length, output.length);
      for (let channelNum = 0; channelNum < channelCount; channelNum++) {
        input[channelNum].forEach((sample, i) => {
          output[channelNum][i] = sample;
        });
      }
    }
    const inputs = inputList[0];
    // There's latency at the beginning of a stream before recording starts
    // Make sure we actually receive audio data before we start storing chunks
    let sliceIndex = 0;
    if (!this.foundAudio) {
      for (const channel of inputs) {
        sliceIndex = 0; // reset for each channel
        if (this.foundAudio) {
          break;
        }
        if (channel) {
          for (const value of channel) {
            if (value !== 0) {
              // find only one non-zero entry in any channel
              this.foundAudio = true;
              break;
            } else {
              sliceIndex++;
            }
          }
        }
      }
    }
    if (inputs && inputs[0] && this.foundAudio && this.recording) {
      // We need to copy the TypedArray, because the \`process\`
      // internals will reuse the same buffer to hold each input
      const chunk = inputs.map((input) => input.slice(sliceIndex));
      this.chunks.push(chunk);
      this.sendChunk(chunk);
    }
    return true;
  }
}

registerProcessor('audio_processor', AudioProcessor);
`],{type:"application/javascript"}),k=URL.createObjectURL(v);class w{constructor({sampleRate:e=44100,outputToSpeakers:t=!1,debug:r=!1}={}){this.scriptSrc=k,this.sampleRate=e,this.outputToSpeakers=t,this.debug=!!r,this._deviceChangeCallback=null,this._devices=[],this.deviceSelection=null,this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)}}static async decode(e,t=44100,r=-1){let i,n;let s=new AudioContext({sampleRate:t});if(e instanceof Blob){if(-1!==r)throw Error('Can not specify "fromSampleRate" when reading from Blob');n=e,i=await n.arrayBuffer()}else if(e instanceof ArrayBuffer){if(-1!==r)throw Error('Can not specify "fromSampleRate" when reading from ArrayBuffer');n=new Blob([i=e],{type:"audio/wav"})}else{let t,s;if(e instanceof Int16Array){s=e,t=new Float32Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r]/32768}else if(e instanceof Float32Array)t=e;else if(e instanceof Array)t=new Float32Array(e);else throw Error('"audioData" must be one of: Blob, Float32Arrray, Int16Array, ArrayBuffer, Array<number>');if(-1===r)throw Error('Must specify "fromSampleRate" when reading from Float32Array, In16Array or Array');if(r<3e3)throw Error('Minimum "fromSampleRate" is 3000 (3kHz)');s||(s=l.floatTo16BitPCM(t));let a={bitsPerSample:16,channels:[t],data:s};n=new l().pack(r,a).blob,i=await n.arrayBuffer()}let a=await s.decodeAudioData(i),o=a.getChannelData(0),c=URL.createObjectURL(n);return{blob:n,url:c,values:o,audioBuffer:a}}log(){return this.debug&&this.log(...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e,t={},r=null){if(!(r=r||this.processor))throw Error("Can not send events without recording first");let i={event:e,id:this._lastEventId++,data:t};r.port.postMessage(i);let n=new Date().valueOf();for(;!this.eventReceipts[i.id];){if(new Date().valueOf()-n>this.eventTimeout)throw Error(`Timeout waiting for "${e}" event`);await new Promise(e=>setTimeout(()=>e(!0),1))}let s=this.eventReceipts[i.id];return delete this.eventReceipts[i.id],s}listenForDeviceChange(e){if(null===e&&this._deviceChangeCallback)navigator.mediaDevices.removeEventListener("devicechange",this._deviceChangeCallback),this._deviceChangeCallback=null;else if(null!==e){let t=0,r=[],i=e=>e.map(e=>e.deviceId).sort().join(","),n=async()=>{let n=++t,s=await this.listDevices();n===t&&i(r)!==i(s)&&(r=s,e(s.slice()))};navigator.mediaDevices.addEventListener("devicechange",n),n(),this._deviceChangeCallback=n}return!0}async requestPermission(){let e=await navigator.permissions.query({name:"microphone"});if("denied"===e.state)window.alert("You must grant microphone access to use this feature.");else if("prompt"===e.state)try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop())}catch(e){window.alert("You must grant microphone access to use this feature.")}return!0}async listDevices(){if(!navigator.mediaDevices||!("enumerateDevices"in navigator.mediaDevices))throw Error("Could not request user devices");return await this.requestPermission(),(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind)}async begin(e){if(this.processor)throw Error("Already connected: please call .end() to start a new session");if(!navigator.mediaDevices||!("getUserMedia"in navigator.mediaDevices))throw Error("Could not request user media");e=e??this.deviceSelection?.deviceId;try{let t={audio:!0};e&&(t.audio={deviceId:{exact:e}}),this.stream=await navigator.mediaDevices.getUserMedia(t)}catch(e){throw Error("Could not start media stream")}this.listDevices().then(t=>{console.log("find current device",t,e=this.stream.getAudioTracks()[0].getSettings().deviceId,this.stream.getAudioTracks()[0].getSettings()),this.deviceSelection=t.find(t=>t.deviceId===e),console.log("current device",this.deviceSelection)});let t=new AudioContext({sampleRate:this.sampleRate}),r=t.createMediaStreamSource(this.stream);try{await t.audioWorklet.addModule(this.scriptSrc)}catch(e){throw console.error(e),Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}let i=new AudioWorkletNode(t,"audio_processor");i.port.onmessage=e=>{let{event:t,id:r,data:i}=e.data;if("receipt"===t)this.eventReceipts[r]=i;else if("chunk"===t){if(this._chunkProcessorSize){let e=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:l.mergeBuffers(e.raw,i.raw),mono:l.mergeBuffers(e.mono,i.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this._chunkProcessor(i)}};let n=r.connect(i),s=t.createAnalyser();return s.fftSize=8192,s.smoothingTimeConstant=.1,n.connect(s),this.outputToSpeakers&&(console.warn("Warning: Output to speakers may affect sound quality,\nespecially due to system audio feedback preventative measures.\nuse only for debugging"),s.connect(t.destination)),this.source=r,this.node=n,this.analyser=s,this.processor=i,console.log("begin completed"),!0}getFrequencies(e="frequency",t=-100,r=-30){if(!this.processor)throw Error("Session ended: please call .begin() first");return y.getFrequencies(this.analyser,this.sampleRate,null,e,t,r)}async pause(){if(this.processor){if(!this.recording)throw Error("Already paused: please call .record() first")}else throw Error("Session ended: please call .begin() first");return this._chunkProcessorBuffer.raw.byteLength&&this._chunkProcessor(this._chunkProcessorBuffer),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(e=()=>{},t=8192){if(this.processor){if(this.recording)throw Error("Already recording: please call .pause() first");if("function"!=typeof e)throw Error("chunkProcessor must be a function")}else throw Error("Session ended: please call .begin() first");return this._chunkProcessor=e,this._chunkProcessorSize=t,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(e=!1){if(!this.processor)throw Error("Session ended: please call .begin() first");if(!e&&this.recording)throw Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");let t=await this._event("export");return new l().pack(this.sampleRate,t.audio)}async end(){if(!this.processor)throw Error("Session ended: please call .begin() first");let e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.stream.getTracks().forEach(e=>e.stop()),this.log("Exporting ...");let t=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,new l().pack(this.sampleRate,t.audio)}async quit(){return this.listenForDeviceChange(null),this.deviceSelection=null,this.processor&&await this.end(),!0}}globalThis.WavRecorder=w;class S{constructor({sampleRate:e=44100,outputToSpeakers:t=!1,debug:r=!1}={}){this.scriptSrc=k,this.sampleRate=e,this.outputToSpeakers=t,this.debug=!!r,this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)}}log(){return this.debug&&this.log(...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e,t={},r=null){if(!(r=r||this.processor))throw Error("Can not send events without recording first");let i={event:e,id:this._lastEventId++,data:t};r.port.postMessage(i);let n=new Date().valueOf();for(;!this.eventReceipts[i.id];){if(new Date().valueOf()-n>this.eventTimeout)throw Error(`Timeout waiting for "${e}" event`);await new Promise(e=>setTimeout(()=>e(!0),1))}let s=this.eventReceipts[i.id];return delete this.eventReceipts[i.id],s}async begin(e){if(this.processor)throw Error("Already connected: please call .end() to start a new session");if(!e||"audio"!==e.kind)throw Error("No audio track provided");this.stream=new MediaStream([e]);let t=new AudioContext({sampleRate:this.sampleRate}),r=t.createMediaStreamSource(this.stream);try{await t.audioWorklet.addModule(this.scriptSrc)}catch(e){throw console.error(e),Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}let i=new AudioWorkletNode(t,"audio_processor");i.port.onmessage=e=>{let{event:t,id:r,data:i}=e.data;if("receipt"===t)this.eventReceipts[r]=i;else if("chunk"===t){if(this._chunkProcessorSize){let e=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:l.mergeBuffers(e.raw,i.raw),mono:l.mergeBuffers(e.mono,i.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this._chunkProcessor(i)}};let n=r.connect(i),s=t.createAnalyser();return s.fftSize=8192,s.smoothingTimeConstant=.1,n.connect(s),this.outputToSpeakers&&(console.warn("Warning: Output to speakers may affect sound quality,\nespecially due to system audio feedback preventative measures.\nuse only for debugging"),s.connect(t.destination)),this.source=r,this.node=n,this.analyser=s,this.processor=i,!0}getFrequencies(e="frequency",t=-100,r=-30){if(!this.processor)throw Error("Session ended: please call .begin() first");return y.getFrequencies(this.analyser,this.sampleRate,null,e,t,r)}async pause(){if(this.processor){if(!this.recording)throw Error("Already paused: please call .record() first")}else throw Error("Session ended: please call .begin() first");return this._chunkProcessorBuffer.raw.byteLength&&this._chunkProcessor(this._chunkProcessorBuffer),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(e=()=>{},t=8192){if(this.processor){if(this.recording)throw Error("Already recording: HELLO please call .pause() first");if("function"!=typeof e)throw Error("chunkProcessor must be a function")}else throw Error("Session ended: please call .begin() first");return this._chunkProcessor=e,this._chunkProcessorSize=t,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(e=!1){if(!this.processor)throw Error("Session ended: please call .begin() first");if(!e&&this.recording)throw Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");let t=await this._event("export");return new l().pack(this.sampleRate,t.audio)}async end(){if(!this.processor)throw Error("Session ended: please call .begin() first");let e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.log("Exporting ...");let t=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,new l().pack(this.sampleRate,t.audio)}async quit(){return this.listenForDeviceChange(null),this.processor&&await this.end(),!0}}globalThis.WavRecorder=WavRecorder;var A={};A=JSON.parse('{"name":"@pipecat-ai/daily-transport","version":"0.3.10","license":"BSD-2-Clause","main":"dist/index.js","module":"dist/index.module.js","types":"dist/index.d.ts","source":"src/index.ts","repository":{"type":"git","url":"git+https://github.com/pipecat-ai/pipecat-client-web-transports.git"},"files":["dist","package.json","README.md"],"scripts":{"build":"parcel build --no-cache","dev":"parcel watch","lint":"eslint . --ext ts --report-unused-disable-directives --max-warnings 0"},"devDependencies":{"@pipecat-ai/client-js":"^0.3.5","eslint":"9.11.1","eslint-config-prettier":"^9.1.0","eslint-plugin-simple-import-sort":"^12.1.1"},"peerDependencies":{"@pipecat-ai/client-js":"~0.3.5"},"dependencies":{"@daily-co/daily-js":"^0.77.0"},"description":"Pipecat Daily Transport Package","author":"Daily.co","bugs":{"url":"https://github.com/pipecat-ai/pipecat-client-web-transports/issues"},"homepage":"https://github.com/pipecat-ai/pipecat-client-web-transports/blob/main/transports/daily-webrtc/README.md"}'),(i=n||(n={})).AUDIO_BUFFERING_STARTED="audio-buffering-started",i.AUDIO_BUFFERING_STOPPED="audio-buffering-stopped";class T{constructor(e){this._daily=e,this._proxy=new Proxy(this._daily,{get:(e,t,r)=>{if("function"==typeof e[t]){let r;switch(String(t)){case"preAuth":r="Calls to preAuth() are disabled. Please use Transport.preAuth()";break;case"startCamera":r="Calls to startCamera() are disabled. Please use RTVIClient.initDevices()";break;case"join":r="Calls to join() are disabled. Please use RTVIClient.connect()";break;case"leave":r="Calls to leave() are disabled. Please use RTVIClient.disconnect()";break;case"destroy":r="Calls to destroy() are disabled."}return r?()=>{throw Error(r)}:(...r)=>e[t](...r)}return Reflect.get(e,t,r)}})}get proxy(){return this._proxy}}class E extends a.J7{constructor({dailyFactoryOptions:e={},bufferLocalAudioUntilBotReady:t=!1}={}){super(),this._botId="",this._selectedCam={},this._selectedMic={},this._selectedSpeaker={},this._currentAudioTrack=null,this._audioQueue=[],this._callbacks={},this._dailyFactoryOptions=e,this._bufferLocalAudioUntilBotReady=t,this._daily=(0,s.ZP).createCallObject({...this._dailyFactoryOptions,allowMultipleCallInstances:!0}),this._dailyWrapper=new T(this._daily)}setupRecorder(){this._mediaStreamRecorder=new S({sampleRate:E.RECORDER_SAMPLE_RATE})}handleUserAudioStream(e){this._audioQueue.push(e)}flushAudioQueue(){if(0!==this._audioQueue.length)for((0,a.kg).debug(`Will flush audio queue: ${this._audioQueue.length}`);this._audioQueue.length>0;){let e=[];for(;e.length<10&&this._audioQueue.length>0;){let t=this._audioQueue.shift();t&&e.push(t)}e.length>0&&this._sendAudioBatch(e)}}_sendAudioBatch(e){let t={id:"raw-audio-batch",label:"rtvi-ai",type:"raw-audio-batch",data:{base64AudioBatch:e.map(e=>btoa(String.fromCharCode(...new Uint8Array(e)))),sampleRate:E.RECORDER_SAMPLE_RATE,numChannels:1}};this.sendMessage(t)}initialize(e,t){var r;this._bufferLocalAudioUntilBotReady&&this.setupRecorder(),this._callbacks=e.callbacks??{},this._onMessage=t,(null==this._dailyFactoryOptions.startVideoOff||null!=e.enableCam)&&(this._dailyFactoryOptions.startVideoOff=!e.enableCam),(null==this._dailyFactoryOptions.startAudioOff||null!=e.enableMic)&&(this._dailyFactoryOptions.startAudioOff=!(e.enableMic??!0)),this.attachEventListeners(),this.state="disconnected",(0,a.kg).debug("[RTVI Transport] Initialized",((r=A)&&r.__esModule?r.default:r).version)}get dailyCallClient(){return this._dailyWrapper.proxy}get state(){return this._state}set state(e){this._state!==e&&(this._state=e,this._callbacks.onTransportStateChanged?.(e))}async getAllCams(){let{devices:e}=await this._daily.enumerateDevices();return e.filter(e=>"videoinput"===e.kind)}updateCam(e){this._daily.setInputDevicesAsync({videoDeviceId:e}).then(e=>{this._selectedCam=e.camera})}get selectedCam(){return this._selectedCam}async getAllMics(){let{devices:e}=await this._daily.enumerateDevices();return e.filter(e=>"audioinput"===e.kind)}updateMic(e){this._daily.setInputDevicesAsync({audioDeviceId:e}).then(e=>{this._selectedMic=e.mic})}get selectedMic(){return this._selectedMic}async getAllSpeakers(){let{devices:e}=await this._daily.enumerateDevices();return e.filter(e=>"audiooutput"===e.kind)}updateSpeaker(e){this._daily.setOutputDeviceAsync({outputDeviceId:e}).then(e=>{this._selectedSpeaker=e.speaker})}get selectedSpeaker(){return this._selectedSpeaker}enableMic(e){this._daily.setLocalAudio(e)}get isMicEnabled(){return this._daily.localAudio()}enableCam(e){this._daily.setLocalVideo(e)}get isCamEnabled(){return this._daily.localVideo()}enableScreenShare(e){e?this._daily.startScreenShare():this._daily.stopScreenShare()}get isSharingScreen(){return this._daily.localScreenAudio()||this._daily.localScreenVideo()}tracks(){let e=this._daily.participants()??{},t=e?.[this._botId],r={local:{audio:e?.local?.tracks?.audio?.persistentTrack,screenAudio:e?.local?.tracks?.screenAudio?.persistentTrack,screenVideo:e?.local?.tracks?.screenVideo?.persistentTrack,video:e?.local?.tracks?.video?.persistentTrack}};return t&&(r.bot={audio:t?.tracks?.audio?.persistentTrack,video:t?.tracks?.video?.persistentTrack}),r}async startRecording(){try{(0,a.kg).info("[RTVI Transport] Initializing recording"),await this._mediaStreamRecorder.record(e=>{this.handleUserAudioStream(e.mono)},E.RECORDER_CHUNK_SIZE),this._onMessage({type:n.AUDIO_BUFFERING_STARTED,data:{}}),(0,a.kg).info("[RTVI Transport] Recording Initialized")}catch(e){e.message.includes("Already recording")||(0,a.kg).error("Error starting recording",e)}}async preAuth(e){this._dailyFactoryOptions=e,await this._daily.preAuth(e)}async initDevices(){if(!this._daily)throw new a.Z7("Transport instance not initialized");this.state="initializing";let e=await this._daily.startCamera(this._dailyFactoryOptions),{devices:t}=await this._daily.enumerateDevices(),r=t.filter(e=>"videoinput"===e.kind),i=t.filter(e=>"audioinput"===e.kind),n=t.filter(e=>"audiooutput"===e.kind);this._selectedCam=e.camera,this._selectedMic=e.mic,this._selectedSpeaker=e.speaker,this._callbacks.onAvailableCamsUpdated?.(r),this._callbacks.onAvailableMicsUpdated?.(i),this._callbacks.onAvailableSpeakersUpdated?.(n),this._callbacks.onCamUpdated?.(e.camera),this._callbacks.onMicUpdated?.(e.mic),this._callbacks.onSpeakerUpdated?.(e.speaker),this._daily.isLocalAudioLevelObserverRunning()||await this._daily.startLocalAudioLevelObserver(100),this._daily.isRemoteParticipantsAudioLevelObserverRunning()||await this._daily.startRemoteParticipantsAudioLevelObserver(100),this.state="initialized"}async connect(e,t){if(!this._daily)throw new a.Z7("Transport instance not initialized");if(t.signal.aborted)return;this.state="connecting";let r=this._dailyFactoryOptions;r.url=e.room_url??r.url,null!=e.token&&(r.token=e.token);try{await this._daily.join(r);let e=await this._daily.room();e&&"id"in e&&(this._expiry=e.config?.exp)}catch(e){throw(0,a.kg).error("Failed to join room",e),this.state="error",new a.EC}t.signal.aborted||(this.state="connected",this._callbacks.onConnected?.())}async sendReadyMessage(){return new Promise(e=>{let t=()=>{let e=navigator.userAgent;return/iPad|iPhone|iPod/.test(e)||/Macintosh/.test(e)&&"ontouchend"in document},r=()=>{this.state="ready",this.flushAudioQueue(),this.sendMessage((0,a.tD).clientReady()),this.stopRecording(),e()},i=e=>{e.participant?.local||(this._daily.off("track-started",i),t()?((0,a.kg).debug("[RTVI Transport] iOS device detected, adding 0.5 second delay before sending ready message"),setTimeout(r,500)):r())};this._daily.on("track-started",i)})}stopRecording(){this._mediaStreamRecorder&&"ended"!==this._mediaStreamRecorder.getStatus()&&(this._mediaStreamRecorder.end(),this._onMessage({type:n.AUDIO_BUFFERING_STOPPED,data:{}}))}attachEventListeners(){this._daily.on("available-devices-updated",this.handleAvailableDevicesUpdated.bind(this)),this._daily.on("selected-devices-updated",this.handleSelectedDevicesUpdated.bind(this)),this._daily.on("track-started",this.handleTrackStarted.bind(this)),this._daily.on("track-stopped",this.handleTrackStopped.bind(this)),this._daily.on("participant-joined",this.handleParticipantJoined.bind(this)),this._daily.on("participant-left",this.handleParticipantLeft.bind(this)),this._daily.on("local-audio-level",this.handleLocalAudioLevel.bind(this)),this._daily.on("remote-participants-audio-level",this.handleRemoteAudioLevel.bind(this)),this._daily.on("app-message",this.handleAppMessage.bind(this)),this._daily.on("left-meeting",this.handleLeftMeeting.bind(this)),this._daily.on("error",this.handleFatalError.bind(this)),this._daily.on("nonfatal-error",this.handleNonFatalError.bind(this))}async disconnect(){this.state="disconnecting",this._daily.stopLocalAudioLevelObserver(),this._daily.stopRemoteParticipantsAudioLevelObserver(),this._audioQueue=[],this._currentAudioTrack=null,this.stopRecording(),await this._daily.leave()}sendMessage(e){this._daily.sendAppMessage(e,"*")}handleAppMessage(e){"rtvi-ai"===e.data.label&&this._onMessage({id:e.data.id,type:e.data.type,data:e.data.data})}handleAvailableDevicesUpdated(e){this._callbacks.onAvailableCamsUpdated?.(e.availableDevices.filter(e=>"videoinput"===e.kind)),this._callbacks.onAvailableMicsUpdated?.(e.availableDevices.filter(e=>"audioinput"===e.kind)),this._callbacks.onAvailableSpeakersUpdated?.(e.availableDevices.filter(e=>"audiooutput"===e.kind))}handleSelectedDevicesUpdated(e){this._selectedCam?.deviceId!==e.devices.camera&&(this._selectedCam=e.devices.camera,this._callbacks.onCamUpdated?.(e.devices.camera)),this._selectedMic?.deviceId!==e.devices.mic&&(this._selectedMic=e.devices.mic,this._callbacks.onMicUpdated?.(e.devices.mic)),this._selectedSpeaker?.deviceId!==e.devices.speaker&&(this._selectedSpeaker=e.devices.speaker,this._callbacks.onSpeakerUpdated?.(e.devices.speaker))}async handleLocalAudioTrack(e){if("ready"!=this.state&&this._bufferLocalAudioUntilBotReady){switch(this._mediaStreamRecorder.getStatus()){case"ended":await this._mediaStreamRecorder.begin(e),await this.startRecording();break;case"paused":await this.startRecording();break;default:this._currentAudioTrack!==e?(await this._mediaStreamRecorder.end(),await this._mediaStreamRecorder.begin(e),await this.startRecording()):(0,a.kg).warn("track-started event received for current track and already recording")}this._currentAudioTrack=e}}handleTrackStarted(e){"screenAudio"===e.type||"screenVideo"===e.type?this._callbacks.onScreenTrackStarted?.(e.track,e.participant?C(e.participant):void 0):(e.participant?.local&&"audio"===e.track.kind&&this.handleLocalAudioTrack(e.track),this._callbacks.onTrackStarted?.(e.track,e.participant?C(e.participant):void 0))}handleTrackStopped(e){"screenAudio"===e.type||"screenVideo"===e.type?this._callbacks.onScreenTrackStopped?.(e.track,e.participant?C(e.participant):void 0):this._callbacks.onTrackStopped?.(e.track,e.participant?C(e.participant):void 0)}handleParticipantJoined(e){let t=C(e.participant);this._callbacks.onParticipantJoined?.(t),t.local||(this._botId=e.participant.session_id,this._callbacks.onBotConnected?.(t))}handleParticipantLeft(e){let t=C(e.participant);this._callbacks.onParticipantLeft?.(t),t.local||(this._botId="",this._callbacks.onBotDisconnected?.(t))}handleLocalAudioLevel(e){this._callbacks.onLocalAudioLevel?.(e.audioLevel)}handleRemoteAudioLevel(e){let t=this._daily.participants(),r=Object.keys(e.participantsAudioLevel);for(let i=0;i<r.length;i++){let n=r[i],s=e.participantsAudioLevel[n];this._callbacks.onRemoteAudioLevel?.(s,C(t[n]))}}handleLeftMeeting(){this.state="disconnected",this._botId="",this._callbacks.onDisconnected?.()}handleFatalError(e){(0,a.kg).error("Daily fatal error",e.errorMsg),this.state="error",this._botId="",this._callbacks.onError?.(a.tD.error(e.errorMsg,!0))}handleNonFatalError(e){"screen-share-error"===e.type&&this._callbacks.onScreenShareError?.(e.errorMsg)}}E.RECORDER_SAMPLE_RATE=16e3,E.RECORDER_CHUNK_SIZE=512;let C=e=>({id:e.user_id,local:e.local,name:e.user_name})},9645:function(e,t,r){"use strict";let i=r(3505),n=r(1963),s=r(6861);e.exports=function e(t,r){switch(n(t)){case"object":return function(t,r){if("function"==typeof r)return r(t);if(r||s(t)){let i=new t.constructor;for(let n in t)i[n]=e(t[n],r);return i}return t}(t,r);case"array":return function(t,r){let i=new t.constructor(t.length);for(let n=0;n<t.length;n++)i[n]=e(t[n],r);return i}(t,r);default:return i(t)}}},6861:function(e,t,r){"use strict";var i=r(2331);function n(e){return!0===i(e)&&"[object Object]"===Object.prototype.toString.call(e)}e.exports=function(e){var t,r;return!1!==n(e)&&"function"==typeof(t=e.constructor)&&!1!==n(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")}},2331:function(e){"use strict";e.exports=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}},1963:function(e){var t=Object.prototype.toString;function r(e){return"function"==typeof e.constructor?e.constructor.name:null}e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var i=typeof e;if("boolean"===i)return"boolean";if("string"===i)return"string";if("number"===i)return"number";if("symbol"===i)return"symbol";if("function"===i)return"GeneratorFunction"===r(e)?"generatorfunction":"function";if(Array.isArray?Array.isArray(e):e instanceof Array)return"array";if(e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e))return"buffer";if(function(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!==e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate)return"date";if(e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit)return"error";if(e instanceof RegExp||"string"==typeof e.flags&&"boolean"==typeof e.ignoreCase&&"boolean"==typeof e.multiline&&"boolean"==typeof e.global)return"regexp";switch(r(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if("function"==typeof e.throw&&"function"==typeof e.return&&"function"==typeof e.next)return"generator";switch(i=t.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return i.slice(8,-1).toLowerCase().replace(/\s/g,"")}},9376:function(e,t,r){"use strict";var i=r(5475);r.o(i,"useParams")&&r.d(t,{useParams:function(){return i.useParams}}),r.o(i,"useRouter")&&r.d(t,{useRouter:function(){return i.useRouter}}),r.o(i,"useSearchParams")&&r.d(t,{useSearchParams:function(){return i.useSearchParams}})},6434:function(e){!function(){var t={675:function(e,t){"use strict";t.byteLength=function(e){var t=c(e),r=t[0],i=t[1];return(r+i)*3/4-i},t.toByteArray=function(e){var t,r,s=c(e),a=s[0],o=s[1],l=new n((a+o)*3/4-o),u=0,h=o>0?a-4:a;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===o&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,l[u++]=255&t),1===o&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},t.fromByteArray=function(e){for(var t,i=e.length,n=i%3,s=[],a=0,o=i-n;a<o;a+=16383)s.push(function(e,t,i){for(var n,s=[],a=t;a<i;a+=3)s.push(r[(n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]))>>18&63]+r[n>>12&63]+r[n>>6&63]+r[63&n]);return s.join("")}(e,a,a+16383>o?o:a+16383));return 1===n?s.push(r[(t=e[i-1])>>2]+r[t<<4&63]+"=="):2===n&&s.push(r[(t=(e[i-2]<<8)+e[i-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),s.join("")};for(var r=[],i=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=s.length;a<o;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var i=r===t?0:4-r%4;return[r,i]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},72:function(e,t,r){"use strict";var i=r(675),n=r(783),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!o.isEncoding(t))throw TypeError("Unknown encoding: "+t);var r=0|p(e,t),i=a(r),n=i.write(e,t);return n!==r&&(i=i.slice(0,n)),i}(e,t);if(ArrayBuffer.isView(e))return h(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(B(e,ArrayBuffer)||e&&B(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(B(e,SharedArrayBuffer)||e&&B(e.buffer,SharedArrayBuffer)))return function(e,t,r){var i;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),o.prototype),i}(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return o.from(i,t,r);var n=function(e){if(o.isBuffer(e)){var t,r=0|d(e.length),i=a(r);return 0===i.length||e.copy(i,0,0,r),i}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?a(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),a(e<0?0:0|d(e))}function h(e){for(var t=e.length<0?0:0|d(e.length),r=a(t),i=0;i<t;i+=1)r[i]=255&e[i];return r}function d(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||B(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return T(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return C(e).length;default:if(n)return i?-1:T(e).length;t=(""+t).toLowerCase(),n=!0}}function f(e,t,r){var n,s,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=t;s<r;++s)n+=L[e[s]];return n}(this,t,r);case"utf8":case"utf-8":return b(this,t,r);case"ascii":return function(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}(this,t,r);case"latin1":case"binary":return function(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}(this,t,r);case"base64":return n=t,s=r,0===n&&s===this.length?i.fromByteArray(this):i.fromByteArray(this.slice(n,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var i=e.slice(t,r),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}(this,t,r);default:if(a)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function g(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function y(e,t,r,i,n){var s;if(0===e.length)return -1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),(s=r=+r)!=s&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return -1;r=e.length-1}else if(r<0){if(!n)return -1;r=0}if("string"==typeof t&&(t=o.from(t,i)),o.isBuffer(t))return 0===t.length?-1:m(e,t,r,i,n);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,i,n);throw TypeError("val must be string, number or Buffer")}function m(e,t,r,i,n){var s,a=1,o=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return -1;a=2,o/=2,c/=2,r/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(n){var u=-1;for(s=r;s<o;s++)if(l(e,s)===l(t,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===c)return u*a}else -1!==u&&(s-=s-u),u=-1}else for(r+c>o&&(r=o-c),s=r;s>=0;s--){for(var h=!0,d=0;d<c;d++)if(l(e,s+d)!==l(t,d)){h=!1;break}if(h)return s}return -1}function b(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var s,a,o,c,l=e[n],u=null,h=l>239?4:l>223?3:l>191?2:1;if(n+h<=r)switch(h){case 1:l<128&&(u=l);break;case 2:(192&(s=e[n+1]))==128&&(c=(31&l)<<6|63&s)>127&&(u=c);break;case 3:s=e[n+1],a=e[n+2],(192&s)==128&&(192&a)==128&&(c=(15&l)<<12|(63&s)<<6|63&a)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:s=e[n+1],a=e[n+2],o=e[n+3],(192&s)==128&&(192&a)==128&&(192&o)==128&&(c=(15&l)<<18|(63&s)<<12|(63&a)<<6|63&o)>65535&&c<1114112&&(u=c)}null===u?(u=65533,h=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var r="",i=0;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return r}(i)}function _(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function v(e,t,r,i,n,s){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw RangeError('"value" argument is out of bounds');if(r+i>e.length)throw RangeError("Index out of range")}function k(e,t,r,i,n,s){if(r+i>e.length||r<0)throw RangeError("Index out of range")}function w(e,t,r,i,s){return t=+t,r>>>=0,s||k(e,t,r,4,34028234663852886e22,-34028234663852886e22),n.write(e,t,r,i,23,4),r+4}function S(e,t,r,i,s){return t=+t,r>>>=0,s||k(e,t,r,8,17976931348623157e292,-17976931348623157e292),n.write(e,t,r,i,52,8),r+8}t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=2147483647,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,r){return(l(e),e<=0)?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)},o.allocUnsafe=function(e){return u(e)},o.allocUnsafeSlow=function(e){return u(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(B(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),B(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,i=t.length,n=0,s=Math.min(r,i);n<s;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,i=o.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var s=e[r];if(B(s,Uint8Array)&&(s=o.from(s)),!o.isBuffer(s))throw TypeError('"list" argument must be an Array of Buffers');s.copy(i,n),n+=s.length}return i},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?b(this,0,e):f.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(o.prototype[s]=o.prototype.inspect),o.prototype.compare=function(e,t,r,i,n){if(B(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,n>>>=0,this===e)return 0;for(var s=n-i,a=r-t,c=Math.min(s,a),l=this.slice(i,n),u=e.slice(t,r),h=0;h<c;++h)if(l[h]!==u[h]){s=l[h],a=u[h];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},o.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var n,s,a,o,c,l,u,h,d,p,f,g,y=this.length-t;if((void 0===r||r>y)&&(r=y),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var m=!1;;)switch(i){case"hex":return function(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var s=t.length;i>s/2&&(i=s/2);for(var a=0;a<i;++a){var o=parseInt(t.substr(2*a,2),16);if(o!=o)break;e[r+a]=o}return a}(this,e,t,r);case"utf8":case"utf-8":return c=t,l=r,R(T(e,this.length-c),this,c,l);case"ascii":return u=t,h=r,R(E(e),this,u,h);case"latin1":case"binary":return n=this,s=e,a=t,o=r,R(E(s),n,a,o);case"base64":return d=t,p=r,R(C(e),this,d,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f=t,g=r,R(function(e,t){for(var r,i,n=[],s=0;s<e.length&&!((t-=2)<0);++s)i=(r=e.charCodeAt(s))>>8,n.push(r%256),n.push(i);return n}(e,this.length-f),this,f,g);default:if(m)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),m=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var i=this.subarray(e,t);return Object.setPrototypeOf(i,o.prototype),i},o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||_(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i},o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||_(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},o.prototype.readUInt8=function(e,t){return e>>>=0,t||_(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||_(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||_(e,t,this.length);for(var i=t,n=1,s=this[e+--i];i>0&&(n*=256);)s+=this[e+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},o.prototype.readInt8=function(e,t){return(e>>>=0,t||_(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||_(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||_(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||_(e,4,this.length),n.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||_(e,4,this.length),n.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||_(e,8,this.length),n.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||_(e,8,this.length),n.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;v(this,e,t,r,n,0)}var s=1,a=0;for(this[t]=255&e;++a<r&&(s*=256);)this[t+a]=e/s&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;v(this,e,t,r,n,0)}var s=r-1,a=1;for(this[t+s]=255&e;--s>=0&&(a*=256);)this[t+s]=e/a&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);v(this,e,t,r,n-1,-n)}var s=0,a=1,o=0;for(this[t]=255&e;++s<r&&(a*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/a>>0)-o&255;return t+r},o.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);v(this,e,t,r,n-1,-n)}var s=r-1,a=1,o=0;for(this[t+s]=255&e;--s>=0&&(a*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/a>>0)-o&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,r){return w(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return w(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return S(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return S(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,i){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n=i-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,i);else if(this===e&&r<t&&t<i)for(var s=n-1;s>=0;--s)e[s+t]=this[s+r];else Uint8Array.prototype.set.call(e,this.subarray(r,i),t);return n},o.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!o.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===e.length){var n,s=e.charCodeAt(0);("utf8"===i&&s<128||"latin1"===i)&&(e=s)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{var a=o.isBuffer(e)?e:o.from(e,i),c=a.length;if(0===c)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<r-t;++n)this[n+t]=a[n%c]}return this};var A=/[^+/0-9A-Za-z-_]/g;function T(e,t){t=t||1/0;for(var r,i=e.length,n=null,s=[],a=0;a<i;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!n){if(r>56319||a+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return s}function E(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function C(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(A,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function R(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length)&&!(n>=e.length);++n)t[n+r]=e[n];return n}function B(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var L=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var i=16*r,n=0;n<16;++n)t[i+n]=e[r]+e[n];return t}()},783:function(e,t){t.read=function(e,t,r,i,n){var s,a,o=8*n-i-1,c=(1<<o)-1,l=c>>1,u=-7,h=r?n-1:0,d=r?-1:1,p=e[t+h];for(h+=d,s=p&(1<<-u)-1,p>>=-u,u+=o;u>0;s=256*s+e[t+h],h+=d,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=i;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===s)s=1-l;else{if(s===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),s-=l}return(p?-1:1)*a*Math.pow(2,s-i)},t.write=function(e,t,r,i,n,s){var a,o,c,l=8*s-n-1,u=(1<<l)-1,h=u>>1,d=23===n?5960464477539062e-23:0,p=i?0:s-1,f=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+h>=1?t+=d/c:t+=d*Math.pow(2,1-h),t*c>=2&&(a++,c/=2),a+h>=u?(o=0,a=u):a+h>=1?(o=(t*c-1)*Math.pow(2,n),a+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,n),a=0));n>=8;e[r+p]=255&o,p+=f,o/=256,n-=8);for(a=a<<n|o,l+=n;l>0;e[r+p]=255&a,p+=f,a/=256,l-=8);e[r+p-f]|=128*g}}},r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var s=r[e]={exports:{}},a=!0;try{t[e](s,s.exports,i),a=!1}finally{a&&delete r[e]}return s.exports}i.ab="//";var n=i(72);e.exports=n}()},1523:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let i=r(8993);function n(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new i.BailoutToCSRError(t);return r}},49:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return s}});let i=r(7437),n=r(544);function s(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=(0,n.getExpectedRequestStore)("next/dynamic css"),s=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));s.push(...t)}}return 0===s.length?null:(0,i.jsx)(i.Fragment,{children:s.map(e=>(0,i.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},3505:function(e,t,r){"use strict";var i=r(6434).Buffer;let n=Symbol.prototype.valueOf,s=r(1963);e.exports=function(e,t){switch(s(e)){case"array":return e.slice();case"object":return Object.assign({},e);case"date":return new e.constructor(Number(e));case"map":return new Map(e);case"set":return new Set(e);case"buffer":return function(e){let t=e.length,r=i.allocUnsafe?i.allocUnsafe(t):i.from(t);return e.copy(r),r}(e);case"symbol":return n?Object(n.call(e)):{};case"arraybuffer":return function(e){let t=new e.constructor(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}(e);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return new e.constructor(e.buffer,e.byteOffset,e.length);case"regexp":return function(e){let t=void 0!==e.flags?e.flags:/\w+$/.exec(e)||void 0,r=new e.constructor(e.source,t);return r.lastIndex=e.lastIndex,r}(e);case"error":return Object.create(e);default:return e}}},8399:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});let i=(0,r(8301).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},5956:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});let i=(0,r(8301).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8208:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});let i=(0,r(8301).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},7819:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});let i=(0,r(8301).Z)("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]])},3734:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});let i=(0,r(8301).Z)("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.34l1 1L22 8v8",key:"ubwiq0"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2l10 10Z",key:"1l10zd"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},7892:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});let i=(0,r(8301).Z)("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]])}}]);